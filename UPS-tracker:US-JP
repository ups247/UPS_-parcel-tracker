<script>
  // Helper: format YYYY-MM-DD
  function formatDate(date) {
    return date.toISOString().split('T')[0];
  }

  // Generate customs inspection events for 60 days
  function generateCustomsEvents(startDate, days) {
    let events = [];
    let d = new Date(startDate);
    let today = new Date();

    for (let i = 0; i < days; i++) {
      let newDate = new Date(d);
      newDate.setDate(d.getDate() + i);

      // Only include events up to today‚Äôs date
      if (newDate <= today) {
        events.push({
          date: formatDate(newDate),
          location: "Shipment STOPPED",
          status: "Under Customs inspection üõÉ"
        });
      }
    }
    return events;
  }

  // Mock shipments database
  const shipments = {
    "MTSO10842424US": [
      { date: "2025-08-25", location: "Texas, USA", status: "Shipment created ‚úÖ" },
      { date: "2025-08-26", location: "Fort Worth, Texas, USA (UPS Office)", status: "Picked up ‚úÖ" },
      { date: "2025-08-27", location: "UPS Global Hub, Louisville, Kentucky 40209, USA", status: "In transit to Japan ‚úÖ" },
      { date: "2025-08-28", location: "Customs Office, Hanedakuko, Ota City, Tokyo 144-0041, Japan", status: "Stopped at Japan Customs Office üõÇ" },

      // Dynamic daily Customs inspection logs
      ...generateCustomsEvents("2025-09-01", 60),

      { date: "____-__-__", location: "Local UPS Facility, Ota City, Tokyo 144-0041, Japan", status: "Out for delivery [Pending ‚ùóÔ∏è]" },
      { date: "____-__-__", location: "Sagami, Seven Town Sengendai Store 1F, Koshigaya-city, Saitama, Japan", status: "Delivering [Pending ‚ùóÔ∏è]" }
    ]
  };

  function track() {
    const tn = document.getElementById("trackingNumber").value.trim();
    const resultDiv = document.getElementById("result");
    resultDiv.innerHTML = "";

    if (shipments[tn]) {
      shipments[tn].forEach(event => {
        let cssClass = "";
        if (event.status.toLowerCase().includes("customs")) cssClass = "customs";
        if (event.status.toLowerCase().includes("delivered")) cssClass = "delivered";
        if (event.status.toLowerCase().includes("in transit")) cssClass = "in-transit";
        if (event.status.toLowerCase().includes("pending")) cssClass = "pending";

        resultDiv.innerHTML += `
          <div class="event ${cssClass}">
            <b>${event.date}</b><br>
            <i>${event.location}</i><br>
            ${event.status}
          </div>
        `;
      });
    } else {
      resultDiv.innerHTML = "<p style='color:red;'>‚ùå Tracking number not found</p>";
    }
  }
</script>
